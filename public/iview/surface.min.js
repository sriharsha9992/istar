var ProteinSurface=(function(){var w,v,u;var B=128;var b=1.4,c=1;var l,s,y;var d;var t;var p,x;var n,m,g,h,f,e;var A=[1.9,1.88,1.63,1.48,1.78,1.2,1.87,1.96,1.63,0.74,1.8,1.48,1.2];var q=new Array(13),r=new Array(13);var z=2;var a,C;var o=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1],[1,1,0],[1,-1,0],[-1,1,0],[-1,-1,0],[1,0,1],[1,0,-1],[-1,0,1],[-1,0,-1],[0,1,1],[0,1,-1],[0,-1,1],[0,-1,-1],[1,1,1],[1,1,-1],[1,-1,1],[-1,1,1],[1,-1,-1],[-1,-1,1],[-1,1,-1],[-1,-1,-1]];this.transformVertices=function(){var D=this.verts;for(var E=0;E<p;++E){D[E].x=D[E].x/c-w;D[E].y=D[E].y/c-v;D[E].z=D[E].z/c-u}};this.getModel=function(G){var M=[],I=this.verts;for(F=0;F<p;++F){M.push(new THREE.Vector3(I[F].x,I[F].y,I[F].z))}var E=new THREE.Geometry();var D=[];E.faces=D;E.vertices=M;for(var F=0;F<x;++F){var H=this.faces[F];var L=I[H.a].atomid,K=I[H.b].atomid,J=I[H.c].atomid;if(!G[L]&&!G[K]&&!G[J]){continue}H.vertexColors=[G[L].color,G[K].color,G[J].color];D.push(H)}E.computeFaceNormals();E.computeVertexNormals(false);return E};this.laplaciansmooth=function(N){var F=new Array(p);for(var J=0;J<p;++J){F[J]={x:0,y:0,z:0}}var D=new Array(20);var K;for(var J=0;J<20;++J){D[J]=new Array(p)}for(var J=0;J<p;++J){D[0][J]=0}for(var J=0;J<x;++J){K=true;for(var I=0;I<D[0][a[J].a];++I){if(a[J].b==D[I+1][a[J].a]){K=false;break}}if(K){D[0][a[J].a]++;D[D[0][a[J].a]][a[J].a]=a[J].b}K=true;for(var I=0;I<D[0][a[J].a];++I){if(a[J].c==D[I+1][a[J].a]){K=false;break}}if(K){D[0][a[J].a]++;D[D[0][a[J].a]][a[J].a]=a[J].c}K=true;for(I=0;I<D[0][a[J].b];++I){if(a[J].a==D[I+1][a[J].b]){K=false;break}}if(K){D[0][a[J].b]++;D[D[0][a[J].b]][a[J].b]=a[J].a}K=true;for(I=0;I<D[0][a[J].b];++I){if(a[J].c==D[I+1][a[J].b]){K=false;break}}if(K){D[0][a[J].b]++;D[D[0][a[J].b]][a[J].b]=a[J].c}K=true;for(I=0;I<D[0][a[J].c];++I){if(a[J].a==D[I+1][a[J].c]){K=false;break}}if(K){D[0][a[J].c]++;D[D[0][a[J].c]][a[J].c]=a[J].a}K=true;for(I=0;I<D[0][a[J].c];++I){if(a[J].b==D[I+1][a[J].c]){K=false;break}}if(K){D[0][a[J].c]++;D[D[0][a[J].c]][a[J].c]=a[J].b}}var L=1;var H=0.5;var E;var M=0.75/(c+3.5);for(var G=0;G<N;++G){for(var J=0;J<p;++J){if(D[0][J]<3){F[J].x=C[J].x;F[J].y=C[J].y;F[J].z=C[J].z}else{if(D[0][J]==3||D[0][J]==4){F[J].x=0;F[J].y=0;F[J].z=0;for(I=0;I<D[0][J];++I){F[J].x+=C[D[I+1][J]].x;F[J].y+=C[D[I+1][J]].y;F[J].z+=C[D[I+1][J]].z}F[J].x+=H*C[J].x;F[J].y+=H*C[J].y;F[J].z+=H*C[J].z;F[J].x/=H+D[0][J];F[J].y/=H+D[0][J];F[J].z/=H+D[0][J]}else{F[J].x=0;F[J].y=0;F[J].z=0;for(var I=0;I<D[0][J];++I){F[J].x+=C[D[I+1][J]].x;F[J].y+=C[D[I+1][J]].y;F[J].z+=C[D[I+1][J]].z}F[J].x+=L*C[J].x;F[J].y+=L*C[J].y;F[J].z+=L*C[J].z;F[J].x/=L+D[0][J];F[J].y/=L+D[0][J];F[J].z/=L+D[0][J]}}}for(var J=0;J<p;++J){C[J].x=F[J].x;C[J].y=F[J].y;C[J].z=F[J].z}}};this.initparm=function(G,E,H){var F=2.5;n=G.x,h=E.x;m=G.y,f=E.y;g=G.z,e=E.z;if(H){n-=F;m-=F;g-=F;h+=F;f+=F;e+=F}else{n-=b+F;m-=b+F;g-=b+F;h+=b+F;f+=b+F;e+=b+F}w=-n;v=-m;u=-g;c=h-n;if((f-m)>c){c=f-m}if((e-g)>c){c=e-g}c=(B-1)/c;B=Math.floor(B*z/c);c=z;var D=180;if(B>D){sfthresh=D/B;B=Math.floor(D);c=c*sfthresh}y=Math.ceil(c*(h-n))+1;s=Math.ceil(c*(f-m))+1;l=Math.ceil(c*(e-g))+1;if(y>B){y=B}if(s>B){s=B}if(l>B){l=B}this.boundingatom(H);cutRadis=b*c;t=new Array(y*s*l)};this.boundingatom=function(J){var I=new Array(13);var G,E,H,D;flagradius=J;for(var F=0;F<13;++F){if(!J){I[F]=A[F]*c+0.5}else{I[F]=(A[F]+b)*c+0.5}H=I[F]*I[F];r[F]=Math.floor(I[F])+1;q[F]=new Array(r[F]*r[F]);indx=0;for(j=0;j<r[F];++j){for(k=0;k<r[F];++k){G=j*j+k*k;if(G>H){q[F][indx]=-1}else{E=Math.sqrt(H-G);q[F][indx]=Math.floor(E)}indx++}}}};this.fillvoxels=function(D){for(var E=0,F=t.length;E<F;++E){t[E]={inout:false,isdone:false,isbound:false,distance:-1,atomid:-1}}for(E in D){this.fillAtom(D[E],D)}for(E=0,F=t.length;E<F;++E){if(t[E].inout){t[E].isdone=true}}this.vp=t;for(var E=0,F=t.length;E<F;++E){if(t[E].inout){t[E].isdone=true}}};this.getAtomType=function(E){var D=10;if(E.name=="CA"){D=0}else{if(E.name=="C"){D=1}else{if(E.elem=="C"){D=7}else{if(E.name=="0"){D=3}else{if(E.elem=="O"){D=11}else{if(E.name=="N"){D=2}else{if(E.elem=="N"){D=8}else{if(E.elem=="S"){D=4}else{if(E.elem=="P"){D=6}else{if(E.name=="FE"){D=9}else{if(E.name=="H"){D=5}else{if(E.elem=="H"){D=12}}}}}}}}}}}}return D};this.fillAtom=function(P,O){var M,K,J,G,F,E;M=Math.floor(0.5+c*(P.coord.x+w));K=Math.floor(0.5+c*(P.coord.y+v));J=Math.floor(0.5+c*(P.coord.z+u));var I=this.getAtomType(P);var N=0;var H=0;for(i=0;i<r[I];++i){for(j=0;j<r[I];++j){if(q[I][N]!=-1){for(ii=-1;ii<2;++ii){for(jj=-1;jj<2;++jj){for(kk=-1;kk<2;++kk){if(ii!=0&&jj!=0&&kk!=0){mi=ii*i;mk=kk*j;for(k=0;k<=q[I][N];++k){mj=k*jj;si=M+mi;sj=K+mj;sk=J+mk;if(si<0||sj<0||sk<0||si>=y||sj>=s||sk>=l){continue}var D=t[si*s*l+sj*l+sk];if(false){D.inout=true}else{if(D.inout==false){D.inout=true;D.atomid=P.serial}else{if(D.inout){var L=O[D.atomid];G=Math.floor(0.5+c*(L.coord.x+w));F=Math.floor(0.5+c*(L.coord.y+v));E=Math.floor(0.5+c*(L.coord.z+u));if(mi*mi+mj*mj+mk*mk<G*G+F*F+E*E){D.atomid=P.serial}}}}}}}}}}N++}}};this.fillvoxelswaals=function(D){for(var E=0,F=t.length;E<F;++E){t[E].isdone=false}for(E in D){this.fillAtomWaals(D[E],D)}};this.fillAtomWaals=function(O,N){var L,J,I,G,F,E,M=0;L=Math.floor(0.5+c*(O.coord.x+w));J=Math.floor(0.5+c*(O.coord.y+v));I=Math.floor(0.5+c*(O.coord.z+u));var H=this.getAtomType(O);for(i=0;i<r[H];++i){for(j=0;j<r[H];++j){if(q[H][M]!=-1){for(ii=-1;ii<2;++ii){for(jj=-1;jj<2;++jj){for(kk=-1;kk<2;++kk){if(ii!=0&&jj!=0&&kk!=0){mi=ii*i;mk=kk*j;for(k=0;k<=q[H][M];++k){mj=k*jj;si=L+mi;sj=J+mj;sk=I+mk;if(si<0||sj<0||sk<0){continue}var D=t[si*s*l+sj*l+sk];if(false){D.isdone=true;continue}else{if(D.isdone==false){D.isdone=true;D.atomid=O.serial}else{if(D.isdone){var K=N[D.atomid];G=Math.floor(0.5+c*(K.coord.x+w));F=Math.floor(0.5+c*(K.coord.y+v));E=Math.floor(0.5+c*(K.coord.z+u));if(mi*mi+mj*mj+mk*mk<G*G+F*F+E*E){D.atomid=O.serial}}}}}}}}}}M++}}};this.buildboundary=function(){t=this.vp;for(i=0;i<y;++i){for(j=0;j<l;++j){for(k=0;k<s;++k){var I=t[i*s*l+k*l+j];if(I.inout){var D=false;var H=0;while(!D&&H<26){var G=i+o[H][0],F=j+o[H][2],E=k+o[H][1];if(G>-1&&G<y&&E>-1&&E<s&&F>-1&&F<l&&!t[G*s*l+E*l+F].inout){I.isbound=true;D=true}else{H++}}}}}}};this.fastdistancemap=function(){var E,J,D;var L;totalsurfacevox=0;totalinnervox=0;var F=new Array(y);for(var K=0;K<y;++K){var O=new Array(s);for(var I=0;I<s;++I){var N=new Array(l);for(var G=0;G<l;++G){N[G]={ix:0,iy:0,iz:0}}O[I]=N}F[K]=O}for(K=0;K<y;++K){for(I=0;I<s;++I){for(G=0;G<l;++G){var H=t[K*s*l+I*l+G];H.isdone=false;if(H.inout){if(H.isbound){totalsurfacevox++;F[K][I][G].ix=K;F[K][I][G].iy=I;F[K][I][G].iz=G;H.distance=0;H.isdone=true}else{totalinnervox++}}}}}inarray=new Array();outarray=new Array();var E=0,J=0;for(K=0;K<y;++K){for(I=0;I<s;++I){for(G=0;G<l;++G){var H=t[K*s*l+I*l+G];if(H.isbound){inarray.push({ix:K,iy:I,iz:G});E++;H.isbound=false}}}}do{J=this.fastoneshell(E,F);E=0;inarray=[];for(K=0;K<J;++K){var P=t[s*l*outarray[K].ix+l*outarray[K].iy+outarray[K].iz];P.isbound=false;if(P.distance<=1.02*cutRadis){inarray.push({ix:outarray[K].ix,iy:outarray[K].iy,iz:outarray[K].iz});E++}}}while(E!=0);var M=c-0.5;if(M<0){M=0}for(K=0;K<y;++K){for(I=0;I<s;++I){for(G=0;G<l;++G){var H=t[K*s*l+I*l+G];H.isbound=false;if(H.inout){if(!H.isdone||(H.isdone&&H.distance>=cutRadis-0.5/(0.1+M))){H.isbound=true}}}}}inarray=[];outarray=[]};this.fastoneshell=function(F,D){var J=0;var K,H,E;var P,O,M;var N;if(F==0){return 0}outarray=[];tnv={ix:-1,iy:-1,iz:-1};for(var I=0;I<F;++I){K=inarray[I].ix;H=inarray[I].iy;E=inarray[I].iz;for(var G=0;G<6;++G){tnv.ix=K+o[G][0];tnv.iy=H+o[G][1];tnv.iz=E+o[G][2];var L=t[tnv.ix*s*l+l*tnv.iy+tnv.iz];if(tnv.ix<y&&tnv.ix>-1&&tnv.iy<s&&tnv.iy>-1&&tnv.iz<l&&tnv.iz>-1&&L.inout&&!L.isdone){D[tnv.ix][tnv.iy][E+o[G][2]].ix=D[K][H][E].ix;D[tnv.ix][tnv.iy][E+o[G][2]].iy=D[K][H][E].iy;D[tnv.ix][tnv.iy][E+o[G][2]].iz=D[K][H][E].iz;P=tnv.ix-D[K][H][E].ix;O=tnv.iy-D[K][H][E].iy;M=tnv.iz-D[K][H][E].iz;var N=P*P+O*O+M*M;L.distance=Math.sqrt(N);L.isdone=true;L.isbound=true;outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz});J++}else{if(tnv.ix<y&&tnv.ix>-1&&tnv.iy<s&&tnv.iy>-1&&tnv.iz<l&&tnv.iz>-1&&L.inout&&L.isdone){P=tnv.ix-D[K][H][E].ix;O=tnv.iy-D[K][H][E].iy;M=tnv.iz-D[K][H][E].iz;N=P*P+O*O+M*M;N=Math.sqrt(N);if(N<L.distance){D[tnv.ix][tnv.iy][tnv.iz].ix=D[K][H][E].ix;D[tnv.ix][tnv.iy][tnv.iz].iy=D[K][H][E].iy;D[tnv.ix][tnv.iy][tnv.iz].iz=D[K][H][E].iz;L.distance=N;if(!L.isbound){L.isbound=true;outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz});J++}}}}}}for(I=0;I<F;++I){K=inarray[I].ix;H=inarray[I].iy;E=inarray[I].iz;for(G=6;G<18;++G){tnv.ix=K+o[G][0];tnv.iy=H+o[G][1];tnv.iz=E+o[G][2];var L=t[tnv.ix*s*l+l*tnv.iy+tnv.iz];if(tnv.ix<y&&tnv.ix>-1&&tnv.iy<s&&tnv.iy>-1&&tnv.iz<l&&tnv.iz>-1&&L.inout&&!L.isdone){D[tnv.ix][tnv.iy][E+o[G][2]].ix=D[K][H][E].ix;D[tnv.ix][tnv.iy][E+o[G][2]].iy=D[K][H][E].iy;D[tnv.ix][tnv.iy][E+o[G][2]].iz=D[K][H][E].iz;P=tnv.ix-D[K][H][E].ix;O=tnv.iy-D[K][H][E].iy;M=tnv.iz-D[K][H][E].iz;N=P*P+O*O+M*M;L.distance=Math.sqrt(N);L.isdone=true;L.isbound=true;outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz});J++}else{if(tnv.ix<y&&tnv.ix>-1&&tnv.iy<s&&tnv.iy>-1&&tnv.iz<l&&tnv.iz>-1&&L.inout&&L.isdone){P=tnv.ix-D[K][H][E].ix;O=tnv.iy-D[K][H][E].iy;M=tnv.iz-D[K][H][E].iz;N=Math.sqrt(P*P+O*O+M*M);if(N<L.distance){D[tnv.ix][tnv.iy][tnv.iz].ix=D[K][H][E].ix;D[tnv.ix][tnv.iy][tnv.iz].iy=D[K][H][E].iy;D[tnv.ix][tnv.iy][tnv.iz].iz=D[K][H][E].iz;L.distance=N;if(!L.isbound){L.isbound=true;outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz});J++}}}}}}for(I=0;I<F;++I){K=inarray[I].ix;H=inarray[I].iy;E=inarray[I].iz;for(G=18;G<26;++G){tnv.ix=K+o[G][0];tnv.iy=H+o[G][1];tnv.iz=E+o[G][2];var L=t[tnv.ix*s*l+l*tnv.iy+tnv.iz];if(tnv.ix<y&&tnv.ix>-1&&tnv.iy<s&&tnv.iy>-1&&tnv.iz<l&&tnv.iz>-1&&L.inout&&!L.isdone){D[tnv.ix][tnv.iy][E+o[G][2]].ix=D[K][H][E].ix;D[tnv.ix][tnv.iy][E+o[G][2]].iy=D[K][H][E].iy;D[tnv.ix][tnv.iy][E+o[G][2]].iz=D[K][H][E].iz;P=tnv.ix-D[K][H][E].ix;O=tnv.iy-D[K][H][E].iy;M=tnv.iz-D[K][H][E].iz;N=P*P+O*O+M*M;L.distance=Math.sqrt(N);L.isdone=true;L.isbound=true;outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz});J++}else{if(tnv.ix<y&&tnv.ix>-1&&tnv.iy<s&&tnv.iy>-1&&tnv.iz<l&&tnv.iz>-1&&L.inout&&L.isdone){P=tnv.ix-D[K][H][E].ix;O=tnv.iy-D[K][H][E].iy;M=tnv.iz-D[K][H][E].iz;N=Math.sqrt(P*P+O*O+M*M);if(N<L.distance){D[tnv.ix][tnv.iy][tnv.iz].ix=D[K][H][E].ix;D[tnv.ix][tnv.iy][tnv.iz].iy=D[K][H][E].iy;D[tnv.ix][tnv.iy][tnv.iz].iz=D[K][H][E].iz;L.distance=N;if(!L.isbound){L.isbound=true;outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz});J++}}}}}}return J};this.marchingcubeinit=function(D){for(var E=0,F=t.length;E<F;++E){if(D==3){t[E].isbound=false}else{if(D==4){t[E].isdone=false;if(t[E].isbound){t[E].isdone=true}t[E].isbound=false}else{if(D==2){if(t[E].isbound&&t[E].isdone){t[E].isbound=false}else{if(t[E].isbound&&!t[E].isdone){t[E].isdone=true}}}else{if(D==3){t[E].isbound=false}}}}}};this.marchingcube=function(E){this.marchingcubeinit(E);var L=new Array(y);for(var R=0;R<y;++R){var W=new Array(s);for(var Q=0;Q<s;++Q){var U=new Array(l);for(var P=0;P<l;++P){U[P]=-1}W[Q]=U}L[R]=W}p=0,x=0;C=new Array();a=new Array();var K,M,S,F;var D=new Array(6);for(var R=0;R<6;++R){D[R]=new Array(3)}for(R=0;R<1;++R){for(Q=0;Q<s-1;++Q){for(P=0;P<l-1;++P){var J=t[s*l*R+l*Q+P].isdone,I=t[s*l*R+l*Q+P+1].isdone,O=t[s*l*R+l*(Q+1)+P].isdone,N=t[s*l*R+l*(Q+1)+P+1].isdone,V=t[s*l*(R+1)+l*Q+P].isdone,T=t[s*l*(R+1)+l*Q+P+1].isdone,H=t[s*l*(R+1)+l*(Q+1)+P].isdone,G=t[s*l*(R+1)+l*(Q+1)+P+1].isdone;if(J&&O&&N&&I){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P+1;D[3][0]=R;D[3][1]=Q;D[3][2]=P+1;for(M=0;M<4;++M){if(L[D[M][0]][D[M][1]][D[M][2]]==-1){L[D[M][0]][D[M][1]][D[M][2]]=p;C.push(new THREE.Vector3(D[M][0],D[M][1],D[M][2]));p++}}a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[2][0]][D[2][1]][D[2][2]],L[D[1][0]][D[1][1]][D[1][2]]));x++;a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[3][0]][D[3][1]][D[3][2]],L[D[2][0]][D[2][1]][D[2][2]]));x++}else{if((J&&O&&N)||(O&&N&&I)||(N&&I&&J)||(I&&J&&O)){if(J&&O&&N){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P+1}else{if(O&&N&&I){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q;D[2][2]=P+1}else{if(N&&I&&J){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q;D[2][2]=P}else{if(I&&J&&O){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P}}}}for(M=0;M<3;++M){if(L[D[M][0]][D[M][1]][D[M][2]]==-1){L[D[M][0]][D[M][1]][D[M][2]]=p;C.push(new THREE.Vector3(D[M][0],D[M][1],D[M][2]));p++}}a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[2][0]][D[2][1]][D[2][2]],L[D[1][0]][D[1][1]][D[1][2]]));x++}}}}}for(R=0;R<y-1;++R){for(Q=0;Q<1;++Q){for(P=0;P<l-1;++P){var J=t[s*l*R+l*Q+P].isdone,I=t[s*l*R+l*Q+P+1].isdone,V=t[s*l*(R+1)+l*Q+P].isdone,T=t[s*l*(R+1)+l*Q+P+1].isdone;if(J&&V&&T&&I){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P+1;D[3][0]=R;D[3][1]=Q;D[3][2]=P+1;for(M=0;M<4;++M){if(L[D[M][0]][D[M][1]][D[M][2]]==-1){L[D[M][0]][D[M][1]][D[M][2]]=p;C.push(new THREE.Vector3(D[M][0],D[M][1],D[M][2]));p++}}a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[1][0]][D[1][1]][D[1][2]],L[D[2][0]][D[2][1]][D[2][2]]));x++;a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[2][0]][D[2][1]][D[2][2]],L[D[3][0]][D[3][1]][D[3][2]]));x++}else{if((J&&V&&T)||(V&&T&&I)||(T&&I&&J)||(I&&J&&V)){if(J&&V&&T){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P+1}else{if(V&&T&&I){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q;D[2][2]=P+1}else{if(T&&I&&J){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q;D[2][2]=P}else{if(I&&J&&V){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P}}}}for(M=0;M<3;++M){if(L[D[M][0]][D[M][1]][D[M][2]]==-1){L[D[M][0]][D[M][1]][D[M][2]]=p;C.push(new THREE.Vector3(D[M][0],D[M][1],D[M][2]));p++}}a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[1][0]][D[1][1]][D[1][2]],L[D[2][0]][D[2][1]][D[2][2]]));x++}}}}}for(R=0;R<y-1;++R){for(Q=0;Q<s-1;++Q){for(P=0;P<1;++P){var J=t[s*l*R+l*Q+P].isdone,O=t[s*l*R+l*(Q+1)+P].isdone,V=t[s*l*(R+1)+l*Q+P].isdone,H=t[s*l*(R+1)+l*(Q+1)+P].isdone;if(J&&V&&H&&O){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P;for(M=0;M<4;++M){if(L[D[M][0]][D[M][1]][D[M][2]]==-1){L[D[M][0]][D[M][1]][D[M][2]]=p;C.push(new THREE.Vector3(D[M][0],D[M][1],D[M][2]));p++}}a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[2][0]][D[2][1]][D[2][2]],L[D[1][0]][D[1][1]][D[1][2]]));x++;a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[3][0]][D[3][1]][D[3][2]],L[D[2][0]][D[2][1]][D[2][2]]));x++}else{if((J&&V&&H)||(V&&H&&O)||(H&&O&&J)||(O&&J&&V)){if(J&&V&&H){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P}else{if(V&&H&&O){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P}else{if(H&&O&&J){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R;D[2][1]=Q;D[2][2]=P}else{if(O&&J&&V){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P}}}}for(M=0;M<3;++M){if(L[D[M][0]][D[M][1]][D[M][2]]==-1){L[D[M][0]][D[M][1]][D[M][2]]=p;C.push(new THREE.Vector3(D[M][0],D[M][1],D[M][2]));p++}}a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[2][0]][D[2][1]][D[2][2]],L[D[1][0]][D[1][1]][D[1][2]]));x++}}}}}for(R=y-1;R<y;++R){for(Q=0;Q<s-1;++Q){for(P=0;P<l-1;++P){var J=t[s*l*R+l*Q+P].isdone,I=t[s*l*R+l*Q+P+1].isdone,O=t[s*l*R+l*(Q+1)+P].isdone,N=t[s*l*R+l*(Q+1)+P+1].isdone;if(J&&O&&N&&I){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P+1;D[3][0]=R;D[3][1]=Q;D[3][2]=P+1;for(M=0;M<4;++M){if(L[D[M][0]][D[M][1]][D[M][2]]==-1){L[D[M][0]][D[M][1]][D[M][2]]=p;C.push(new THREE.Vector3(D[M][0],D[M][1],D[M][2]));p++}}a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[1][0]][D[1][1]][D[1][2]],L[D[2][0]][D[2][1]][D[2][2]]));x++;a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[2][0]][D[2][1]][D[2][2]],L[D[3][0]][D[3][1]][D[3][2]]));x++}else{if((J&&O&&N)||(O&&N&&I)||(N&&I&&J)||(I&&J&&O)){if(J&&O&&N){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P+1}else{if(O&&N&&I){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q;D[2][2]=P+1}else{if(N&&I&&J){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q;D[2][2]=P}else{if(I&&J&&O){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P}}}}for(M=0;M<3;++M){if(L[D[M][0]][D[M][1]][D[M][2]]==-1){L[D[M][0]][D[M][1]][D[M][2]]=p;C.push(new THREE.Vector3(D[M][0],D[M][1],D[M][2]));p++}}a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[1][0]][D[1][1]][D[1][2]],L[D[2][0]][D[2][1]][D[2][2]]));x++}}}}}for(R=0;R<y-1;++R){for(Q=s-1;Q<s;++Q){for(P=0;P<l-1;++P){var J=t[s*l*R+l*Q+P].isdone,I=t[s*l*R+l*Q+P+1].isdone,V=t[s*l*(R+1)+l*Q+P].isdone,T=t[s*l*(R+1)+l*Q+P+1].isdone;if(J&&V&&T&&I){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P+1;D[3][0]=R;D[3][1]=Q;D[3][2]=P+1;for(M=0;M<4;++M){if(L[D[M][0]][D[M][1]][D[M][2]]==-1){L[D[M][0]][D[M][1]][D[M][2]]=p;C.push(new THREE.Vector3(D[M][0],D[M][1],D[M][2]));p++}}a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[2][0]][D[2][1]][D[2][2]],L[D[1][0]][D[1][1]][D[1][2]]));x++;a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[3][0]][D[3][1]][D[3][2]],L[D[2][0]][D[2][1]][D[2][2]]));x++}else{if((J&&V&&T)||(V&&T&&I)||(T&&I&&J)||(I&&J&&V)){if(J&&V&&T){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P+1}else{if(V&&T&&I){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q;D[2][2]=P+1}else{if(T&&I&&J){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q;D[2][2]=P}else{if(I&&J&&V){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P}}}}for(M=0;M<3;++M){if(L[D[M][0]][D[M][1]][D[M][2]]==-1){L[D[M][0]][D[M][1]][D[M][2]]=p;C.push(new THREE.Vector3(D[M][0],D[M][1],D[M][2]));p++}}a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[2][0]][D[2][1]][D[2][2]],L[D[1][0]][D[1][1]][D[1][2]]));x++}}}}}for(R=0;R<y-1;++R){for(Q=0;Q<s-1;++Q){for(P=l-1;P<l;++P){var J=t[s*l*R+l*Q+P].isdone,O=t[s*l*R+l*(Q+1)+P].isdone,V=t[s*l*(R+1)+l*Q+P].isdone,H=t[s*l*(R+1)+l*(Q+1)+P].isdone;if(J&&V&&H&&O){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P;for(M=0;M<4;++M){if(L[D[M][0]][D[M][1]][D[M][2]]==-1){L[D[M][0]][D[M][1]][D[M][2]]=p;C.push(new THREE.Vector3(D[M][0],D[M][1],D[M][2]));p++}}a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[1][0]][D[1][1]][D[1][2]],L[D[2][0]][D[2][1]][D[2][2]]));x++;a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[2][0]][D[2][1]][D[2][2]],L[D[3][0]][D[3][1]][D[3][2]]));x++}else{if((J&&V&&H)||(V&&H&&O)||(H&&O&&J)||(O&&J&&V)){if(J&&V&&H){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P}else{if(V&&H&&O){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P}else{if(H&&O&&J){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R;D[2][1]=Q;D[2][2]=P}else{if(O&&J&&V){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P}}}}for(M=0;M<3;++M){if(L[D[M][0]][D[M][1]][D[M][2]]==-1){L[D[M][0]][D[M][1]][D[M][2]]=p;C.push(new THREE.Vector3(D[M][0],D[M][1],D[M][2]));p++}}a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[1][0]][D[1][1]][D[1][2]],L[D[2][0]][D[2][1]][D[2][2]]));x++}}}}}for(R=0;R<y-1;++R){for(Q=0;Q<s-1;++Q){for(P=0;P<l-1;++P){var J=t[s*l*R+l*Q+P].isdone,I=t[s*l*R+l*Q+P+1].isdone,O=t[s*l*R+l*(Q+1)+P].isdone,N=t[s*l*R+l*(Q+1)+P+1].isdone,V=t[s*l*(R+1)+l*Q+P].isdone,T=t[s*l*(R+1)+l*Q+P+1].isdone,H=t[s*l*(R+1)+l*(Q+1)+P].isdone,G=t[s*l*(R+1)+l*(Q+1)+P+1].isdone;var K=0;for(M=0;M<2;++M){for(S=0;S<2;++S){for(F=0;F<2;++F){if(t[s*l*(R+M)+l*(Q+S)+P+F].isdone){K++}}}}if(K==3){if((J&&V&&H)||(J&&O&&H)||(O&&V&&H)||(J&&O&&V)||(I&&T&&G)||(I&&N&&G)||(N&&T&&G)||(I&&N&&T)||(J&&V&&T)||(V&&T&&I)||(J&&T&&I)||(J&&V&&I)||(H&&V&&G)||(H&&T&&G)||(V&&T&&G)||(H&&V&&T)||(H&&O&&N)||(O&&N&&G)||(H&&N&&G)||(H&&O&&G)||(J&&O&&I)||(J&&I&&N)||(I&&O&&N)||(J&&O&&N)){if(J&&V&&H){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P}else{if(J&&O&&H){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R;D[2][1]=Q;D[2][2]=P}else{if(O&&V&&H){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P}else{if(J&&O&&V){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P}else{if(I&&T&&G){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q;D[2][2]=P+1}else{if(I&&N&&G){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P+1;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P+1}else{if(N&&T&&G){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P+1;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P+1}else{if(I&&N&&T){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P+1}else{if(J&&V&&T){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R;D[2][1]=Q;D[2][2]=P}else{if(V&&T&&I){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P}else{if(J&&T&&I){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P+1}else{if(J&&V&&I){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[2][0]=R;D[2][1]=Q;D[2][2]=P+1}else{if(H&&V&&G){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P}else{if(H&&T&&G){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P+1;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P}else{if(V&&T&&G){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P+1}else{if(H&&V&&T){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P+1}else{if(H&&O&&N){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P}else{if(O&&N&&G){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P}else{if(H&&N&&G){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P+1}else{if(H&&O&&G){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P+1}else{if(J&&O&&I){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P}else{if(J&&I&&N){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q;D[2][2]=P}else{if(I&&O&&N){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q;D[2][2]=P+1}else{if(J&&O&&N){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P+1}}}}}}}}}}}}}}}}}}}}}}}}for(M=0;M<3;++M){if(L[D[M][0]][D[M][1]][D[M][2]]==-1){L[D[M][0]][D[M][1]][D[M][2]]=p;C.push(new THREE.Vector3(D[M][0],D[M][1],D[M][2]));p++}}a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[1][0]][D[1][1]][D[1][2]],L[D[2][0]][D[2][1]][D[2][2]]));x++}}else{if(K==4){if((J&&V&&H&&O)||(I&&T&&G&&N)||(J&&V&&T&&I)||(H&&V&&T&&G)||(H&&O&&N&&G)||(J&&O&&I&&N)){if(J&&V&&H&&O){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P}else{if(I&&T&&G&&N){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[3][0]=R+1;D[3][1]=Q;D[3][2]=P+1;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P+1;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P+1}else{if(J&&V&&T&&I){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[3][0]=R+1;D[3][1]=Q;D[3][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P+1}else{if(H&&V&&T&&G){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P+1;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P+1}else{if(H&&O&&N&&G){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P+1;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P+1}else{if(J&&O&&I&&N){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P+1;D[3][0]=R;D[3][1]=Q;D[3][2]=P+1}}}}}}for(M=0;M<4;++M){if(L[D[M][0]][D[M][1]][D[M][2]]==-1){L[D[M][0]][D[M][1]][D[M][2]]=p;C.push(new THREE.Vector3(D[M][0],D[M][1],D[M][2]));p++}}a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[1][0]][D[1][1]][D[1][2]],L[D[2][0]][D[2][1]][D[2][2]]));x++;a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[2][0]][D[2][1]][D[2][2]],L[D[3][0]][D[3][1]][D[3][2]]));x++}else{if((J&&V&&H&&N)||(J&&O&&H&&T)||(O&&V&&H&&I)||(J&&O&&V&&G)||(I&&T&&G&&O)||(I&&N&&G&&V)||(N&&T&&G&&J)||(I&&N&&T&&H)||(J&&V&&T&&N)||(V&&T&&I&&O)||(J&&T&&I&&H)||(J&&V&&I&&G)||(H&&V&&G&&I)||(H&&T&&G&&J)||(V&&T&&G&&O)||(H&&V&&T&&N)||(H&&O&&N&&T)||(O&&N&&G&&V)||(H&&N&&G&&J)||(H&&O&&G&&I)||(J&&O&&I&&G)||(J&&I&&N&&H)||(I&&O&&N&&V)||(J&&O&&N&&T)){if(J&&V&&H&&N){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P}else{if(J&&O&&H&&T){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R;D[2][1]=Q;D[2][2]=P}else{if(O&&V&&H&&I){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P}else{if(J&&O&&V&&G){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P}else{if(I&&T&&G&&O){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q;D[2][2]=P+1}else{if(I&&N&&G&&V){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P+1;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P+1}else{if(N&&T&&G&&J){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P+1;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P+1}else{if(I&&N&&T&&H){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P+1}else{if(J&&V&&T&&N){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R;D[2][1]=Q;D[2][2]=P}else{if(V&&T&&I&&O){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P}else{if(J&&T&&I&&H){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P+1}else{if(J&&V&&I&&G){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[2][0]=R;D[2][1]=Q;D[2][2]=P+1}else{if(H&&V&&G&&I){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P}else{if(H&&T&&G&&J){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P+1;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P}else{if(V&&T&&G&&O){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P+1}else{if(H&&V&&T&&N){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P+1}else{if(H&&O&&N&&T){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P}else{if(O&&N&&G&&V){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P}else{if(H&&N&&G&&J){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P+1}else{if(H&&O&&G&&I){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P+1}else{if(J&&O&&I&&G){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P}else{if(J&&I&&N&&H){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q;D[2][2]=P}else{if(I&&O&&N&&V){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q;D[2][2]=P+1}else{if(J&&O&&N&&T){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P+1}}}}}}}}}}}}}}}}}}}}}}}}for(M=0;M<3;++M){if(L[D[M][0]][D[M][1]][D[M][2]]==-1){L[D[M][0]][D[M][1]][D[M][2]]=p;C.push(new THREE.Vector3(D[M][0],D[M][1],D[M][2]));p++}}a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[1][0]][D[1][1]][D[1][2]],L[D[2][0]][D[2][1]][D[2][2]]));x++}else{if((J&&N&&H&&O)||(J&&V&&H&&T)||(J&&I&&V&&O)||(O&&V&&H&&G)||(I&&N&&G&&O)||(I&&V&&G&&T)||(J&&I&&T&&N)||(N&&T&&H&&G)){if(O&&N&&J&&H){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P}else{if(V&&T&&H&&J){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R;D[2][1]=Q;D[2][2]=P}else{if(J&&I&&V&&O){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P}else{if(H&&G&&O&&V){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P}else{if(O&&N&&G&&I){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P;D[2][0]=R;D[2][1]=Q;D[2][2]=P+1;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P+1}else{if(V&&T&&G&&I){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P+1}else{if(J&&I&&T&&N){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P+1;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P+1}else{if(N&&T&&H&&G){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P+1;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P+1}}}}}}}}for(M=0;M<3;++M){if(L[D[M][0]][D[M][1]][D[M][2]]==-1){L[D[M][0]][D[M][1]][D[M][2]]=p;C.push(new THREE.Vector3(D[M][0],D[M][1],D[M][2]));p++}}a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[1][0]][D[1][1]][D[1][2]],L[D[2][0]][D[2][1]][D[2][2]]));x++}else{if((J&&V&&H&&I)||(O&&V&&H&&T)||(O&&J&&H&&G)||(O&&J&&V&&N)||(N&&I&&T&&V)||(G&&I&&T&&H)||(G&&N&&T&&O)||(G&&N&&I&&J)||(H&&N&&I&&O)||(T&&J&&I&&O)||(T&&J&&G&&V)||(N&&H&&G&&V)){if(J&&V&&H&&I){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R;D[2][1]=Q;D[2][2]=P;D[3][0]=R;D[3][1]=Q;D[3][2]=P+1}else{if(O&&V&&H&&T){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P;D[3][0]=R+1;D[3][1]=Q;D[3][2]=P+1}else{if(O&&J&&H&&G){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P+1}else{if(O&&J&&V&&N){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P+1}else{if(N&&I&&T&&V){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R;D[2][1]=Q;D[2][2]=P+1;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P+1}else{if(G&&I&&T&&H){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P+1;D[3][0]=R;D[3][1]=Q;D[3][2]=P+1}else{if(G&&N&&T&&O){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P+1;D[3][0]=R+1;D[3][1]=Q;D[3][2]=P+1}else{if(G&&N&&I&&J){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P+1;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P+1}else{if(H&&N&&I&&O){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P+1;D[3][0]=R;D[3][1]=Q;D[3][2]=P+1}else{if(T&&J&&I&&O){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R;D[2][1]=Q;D[2][2]=P+1;D[3][0]=R+1;D[3][1]=Q;D[3][2]=P+1}else{if(T&&J&&G&&V){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P+1;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P+1}else{if(N&&H&&G&&V){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P+1;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P+1}}}}}}}}}}}}for(M=0;M<4;++M){if(L[D[M][0]][D[M][1]][D[M][2]]==-1){L[D[M][0]][D[M][1]][D[M][2]]=p;C.push(new THREE.Vector3(D[M][0],D[M][1],D[M][2]));p++}}a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[1][0]][D[1][1]][D[1][2]],L[D[2][0]][D[2][1]][D[2][2]]));x++;a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[2][0]][D[2][1]][D[2][2]],L[D[3][0]][D[3][1]][D[3][2]]));x++}else{if((J&&V&&O&&T)||(J&&V&&H&&G)||(O&&V&&H&&N)||(O&&J&&H&&I)||(G&&I&&T&&J)||(G&&N&&T&&V)||(G&&N&&I&&H)||(T&&N&&I&&O)||(G&&N&&J&&O)||(V&&J&&I&&N)||(T&&I&&H&&V)||(O&&H&&G&&T)){if(J&&V&&O&&T){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R;D[2][1]=Q;D[2][2]=P;D[3][0]=R+1;D[3][1]=Q;D[3][2]=P+1}else{if(J&&V&&H&&G){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P+1}else{if(O&&V&&H&&N){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P+1}else{if(O&&J&&H&&I){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P;D[3][0]=R;D[3][1]=Q;D[3][2]=P+1}else{if(G&&I&&T&&J){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[2][0]=R;D[2][1]=Q;D[2][2]=P+1;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P+1}else{if(G&&N&&T&&V){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P+1;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P+1}else{if(G&&N&&I&&H){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P+1;D[3][0]=R;D[3][1]=Q;D[3][2]=P+1}else{if(T&&N&&I&&O){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P+1;D[3][0]=R+1;D[3][1]=Q;D[3][2]=P+1}else{if(G&&N&&J&&O){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P+1;D[3][0]=R;D[3][1]=Q;D[3][2]=P}else{if(V&&J&&I&&N){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q;D[2][2]=P+1;D[3][0]=R+1;D[3][1]=Q;D[3][2]=P}else{if(T&&I&&H&&V){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P;D[1][0]=R;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P+1;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P}else{if(O&&H&&G&&T){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P+1;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P}}}}}}}}}}}}for(M=0;M<4;++M){if(L[D[M][0]][D[M][1]][D[M][2]]==-1){L[D[M][0]][D[M][1]][D[M][2]]=p;C.push(new THREE.Vector3(D[M][0],D[M][1],D[M][2]));p++}}a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[1][0]][D[1][1]][D[1][2]],L[D[2][0]][D[2][1]][D[2][2]]));x++;a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[2][0]][D[2][1]][D[2][2]],L[D[3][0]][D[3][1]][D[3][2]]));x++}}}}}}else{if(K==5){if((!V&&!I&&!G)||(!O&&!I&&!G)||(!H&&!T&&!N)||(!J&&!T&&!N)||(!T&&!J&&!H)||(!N&&!J&&!H)||(!G&&!V&&!O)||(!I&&!V&&!O)){if(!V&&!I&&!G){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P}else{if(!O&&!I&&!G){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R;D[2][1]=Q;D[2][2]=P}else{if(!H&&!T&&!N){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P}else{if(!J&&!T&&!N){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P}else{if(!T&&!J&&!H){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P;D[2][0]=R;D[2][1]=Q;D[2][2]=P+1;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P+1}else{if(!N&&!J&&!H){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P+1}else{if(!G&&!V&&!O){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P+1;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P+1}else{if(!I&&!V&&!O){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P+1;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P+1}}}}}}}}for(M=0;M<3;++M){if(L[D[M][0]][D[M][1]][D[M][2]]==-1){L[D[M][0]][D[M][1]][D[M][2]]=p;C.push(new THREE.Vector3(D[M][0],D[M][1],D[M][2]));p++}}a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[1][0]][D[1][1]][D[1][2]],L[D[2][0]][D[2][1]][D[2][2]]));x++}else{if((!J&&!V&&!H)||(!J&&!O&&!H)||(!O&&!V&&!H)||(!J&&!O&&!V)||(!I&&!T&&!G)||(!I&&!N&&!G)||(!N&&!T&&!G)||(!I&&!N&&!T)||(!J&&!V&&!T)||(!V&&!T&&!I)||(!J&&!T&&!I)||(!J&&!V&&!I)||(!H&&!V&&!G)||(!H&&!T&&!G)||(!V&&!T&&!G)||(!H&&!V&&!T)||(!H&&!O&&!N)||(!O&&!N&&!G)||(!H&&!N&&!G)||(!H&&!O&&!G)||(!J&&!O&&!I)||(!J&&!I&&!N)||(!I&&!O&&!N)||(!J&&!O&&!N)){if(!J&&!V&&!H){D[2][0]=R;D[2][1]=Q;D[2][2]=P+1;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P+1;D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P+1;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P}else{if(!J&&!O&&!H){D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P+1;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P+1;D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[3][0]=R+1;D[3][1]=Q;D[3][2]=P}else{if(!O&&!V&&!H){D[2][0]=R+1;D[2][1]=Q;D[2][2]=P+1;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P+1;D[0][0]=R;D[0][1]=Q+1;D[0][2]=P+1;D[3][0]=R;D[3][1]=Q;D[3][2]=P}else{if(!J&&!O&&!V){D[2][0]=R;D[2][1]=Q+1;D[2][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P+1;D[0][0]=R+1;D[0][1]=Q;D[0][2]=P+1;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P}else{if(!I&&!T&&!G){D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P+1}else{if(!I&&!N&&!G){D[2][0]=R;D[2][1]=Q;D[2][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P;D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P;D[3][0]=R+1;D[3][1]=Q;D[3][2]=P+1}else{if(!N&&!T&&!G){D[2][0]=R;D[2][1]=Q+1;D[2][2]=P;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P;D[0][0]=R+1;D[0][1]=Q;D[0][2]=P;D[3][0]=R;D[3][1]=Q;D[3][2]=P+1}else{if(!I&&!N&&!T){D[2][0]=R+1;D[2][1]=Q;D[2][2]=P;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[0][0]=R;D[0][1]=Q+1;D[0][2]=P;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P+1}else{if(!J&&!V&&!T){D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P+1;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P;D[0][0]=R;D[0][1]=Q+1;D[0][2]=P;D[3][0]=R;D[3][1]=Q;D[3][2]=P+1}else{if(!V&&!T&&!I){D[2][0]=R;D[2][1]=Q+1;D[2][2]=P+1;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P+1;D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P;D[3][0]=R;D[3][1]=Q;D[3][2]=P}else{if(!J&&!T&&!I){D[2][0]=R;D[2][1]=Q+1;D[2][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P+1;D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P+1;D[3][0]=R+1;D[3][1]=Q;D[3][2]=P}else{if(!J&&!V&&!I){D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P;D[0][0]=R;D[0][1]=Q+1;D[0][2]=P+1;D[3][0]=R+1;D[3][1]=Q;D[3][2]=P+1}else{if(!H&&!V&&!G){D[2][0]=R;D[2][1]=Q+1;D[2][2]=P+1;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P;D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[3][0]=R+1;D[3][1]=Q;D[3][2]=P+1}else{if(!H&&!T&&!G){D[2][0]=R;D[2][1]=Q;D[2][2]=P+1;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P+1;D[0][0]=R;D[0][1]=Q+1;D[0][2]=P;D[3][0]=R+1;D[3][1]=Q;D[3][2]=P}else{if(!V&&!T&&!G){D[2][0]=R;D[2][1]=Q;D[2][2]=P;D[1][0]=R;D[1][1]=Q;D[1][2]=P+1;D[0][0]=R;D[0][1]=Q+1;D[0][2]=P+1;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P}else{if(!H&&!V&&!T){D[2][0]=R;D[2][1]=Q+1;D[2][2]=P;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P+1}else{if(!H&&!O&&!N){D[2][0]=R;D[2][1]=Q;D[2][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[0][0]=R+1;D[0][1]=Q;D[0][2]=P;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P+1}else{if(!O&&!N&&!G){D[2][0]=R+1;D[2][1]=Q;D[2][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P+1;D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P}else{if(!H&&!N&&!G){D[2][0]=R+1;D[2][1]=Q;D[2][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P+1;D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P}else{if(!H&&!O&&!G){D[2][0]=R;D[2][1]=Q;D[2][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[0][0]=R+1;D[0][1]=Q;D[0][2]=P+1;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P+1}else{if(!J&&!O&&!I){D[2][0]=R+1;D[2][1]=Q;D[2][2]=P+1;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P+1}else{if(!J&&!I&&!N){D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P+1;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P+1;D[0][0]=R+1;D[0][1]=Q;D[0][2]=P;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P}else{if(!I&&!O&&!N){D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P+1;D[0][0]=R+1;D[0][1]=Q;D[0][2]=P+1;D[3][0]=R;D[3][1]=Q;D[3][2]=P}else{if(!J&&!O&&!N){D[2][0]=R+1;D[2][1]=Q;D[2][2]=P;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P;D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P+1;D[3][0]=R;D[3][1]=Q;D[3][2]=P+1}}}}}}}}}}}}}}}}}}}}}}}}for(M=0;M<4;++M){if(L[D[M][0]][D[M][1]][D[M][2]]==-1){L[D[M][0]][D[M][1]][D[M][2]]=p;C.push(new THREE.Vector3(D[M][0],D[M][1],D[M][2]));p++}}a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[1][0]][D[1][1]][D[1][2]],L[D[2][0]][D[2][1]][D[2][2]]));x++;a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[2][0]][D[2][1]][D[2][2]],L[D[3][0]][D[3][1]][D[3][2]]));x++}else{if((!J&&!V&&!G)||(!O&&!H&&!I)||(!N&&!G&&!V)||(!I&&!T&&!H)||(!J&&!O&&!G)||(!T&&!G&&!O)||(!V&&!H&&!N)||(!I&&!N&&!H)||(!J&&!I&&!G)||(!H&&!G&&!J)||(!V&&!T&&!N)||(!O&&!N&&!T)){if(!J&&!V&&!G){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P;D[3][0]=R+1;D[3][1]=Q;D[3][2]=P+1;D[4][0]=R;D[4][1]=Q+1;D[4][2]=P+1}else{if(!O&&!H&&!I){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R;D[2][1]=Q;D[2][2]=P;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P+1;D[4][0]=R+1;D[4][1]=Q;D[4][2]=P+1}else{if(!N&&!G&&!V){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P+1;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P;D[4][0]=R;D[4][1]=Q;D[4][2]=P}else{if(!I&&!T&&!H){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P+1;D[4][0]=R;D[4][1]=Q+1;D[4][2]=P}else{if(!J&&!O&&!G){D[1][0]=R;D[1][1]=Q;D[1][2]=P+1;D[0][0]=R+1;D[0][1]=Q;D[0][2]=P;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P+1;D[4][0]=R+1;D[4][1]=Q;D[4][2]=P+1}else{if(!T&&!G&&!O){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P+1;D[4][0]=R;D[4][1]=Q;D[4][2]=P}else{if(!V&&!H&&!N){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P+1;D[4][0]=R;D[4][1]=Q;D[4][2]=P+1}else{if(!I&&!N&&!H){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P+1;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P;D[4][0]=R+1;D[4][1]=Q;D[4][2]=P}else{if(!J&&!I&&!G){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P+1;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P+1;D[4][0]=R+1;D[4][1]=Q+1;D[4][2]=P}else{if(!H&&!G&&!J){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P;D[4][0]=R;D[4][1]=Q;D[4][2]=P+1}else{if(!V&&!T&&!N){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P+1;D[3][0]=R;D[3][1]=Q;D[3][2]=P+1;D[4][0]=R;D[4][1]=Q+1;D[4][2]=P}else{if(!O&&!N&&!T){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[2][0]=R;D[2][1]=Q;D[2][2]=P+1;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P+1;D[4][0]=R+1;D[4][1]=Q;D[4][2]=P}}}}}}}}}}}}for(M=0;M<5;++M){if(L[D[M][0]][D[M][1]][D[M][2]]==-1){L[D[M][0]][D[M][1]][D[M][2]]=p;C.push(new THREE.Vector3(D[M][0],D[M][1],D[M][2]));p++}}a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[1][0]][D[1][1]][D[1][2]],L[D[2][0]][D[2][1]][D[2][2]]));x++;a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[2][0]][D[2][1]][D[2][2]],L[D[3][0]][D[3][1]][D[3][2]]));x++;a.push(new THREE.Face3(L[D[2][0]][D[2][1]][D[2][2]],L[D[4][0]][D[4][1]][D[4][2]],L[D[3][0]][D[3][1]][D[3][2]]));x++}else{if((!J&&!V&&!N)||(!O&&!H&&!T)||(!N&&!G&&!J)||(!I&&!T&&!O)||(!J&&!O&&!T)||(!T&&!G&&!J)||(!V&&!H&&!I)||(!I&&!N&&!V)||(!J&&!I&&!H)||(!H&&!G&&!I)||(!V&&!T&&!O)||(!O&&!N&&!V)){if(!J&&!V&&!N){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P;D[3][0]=R+1;D[3][1]=Q;D[3][2]=P+1;D[4][0]=R+1;D[4][1]=Q+1;D[4][2]=P+1}else{if(!O&&!H&&!T){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R;D[2][1]=Q;D[2][2]=P;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P+1;D[4][0]=R;D[4][1]=Q;D[4][2]=P+1}else{if(!N&&!G&&!J){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P+1;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P;D[4][0]=R+1;D[4][1]=Q;D[4][2]=P}else{if(!I&&!T&&!O){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P+1;D[4][0]=R+1;D[4][1]=Q+1;D[4][2]=P}else{if(!J&&!O&&!T){D[1][0]=R;D[1][1]=Q;D[1][2]=P+1;D[0][0]=R+1;D[0][1]=Q;D[0][2]=P;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P+1;D[4][0]=R+1;D[4][1]=Q+1;D[4][2]=P+1}else{if(!T&&!G&&!J){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P+1;D[4][0]=R;D[4][1]=Q+1;D[4][2]=P}else{if(!V&&!H&&!I){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P+1;D[4][0]=R;D[4][1]=Q+1;D[4][2]=P+1}else{if(!I&&!N&&!V){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P+1;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P;D[4][0]=R+1;D[4][1]=Q+1;D[4][2]=P}else{if(!J&&!I&&!H){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P+1;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P+1;D[4][0]=R+1;D[4][1]=Q+1;D[4][2]=P+1}else{if(!H&&!G&&!I){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P;D[4][0]=R;D[4][1]=Q;D[4][2]=P}else{if(!V&&!T&&!O){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P+1;D[3][0]=R;D[3][1]=Q;D[3][2]=P+1;D[4][0]=R;D[4][1]=Q+1;D[4][2]=P+1}else{if(!O&&!N&&!V){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[2][0]=R;D[2][1]=Q;D[2][2]=P+1;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P+1;D[4][0]=R+1;D[4][1]=Q;D[4][2]=P+1}}}}}}}}}}}}for(M=0;M<5;++M){if(L[D[M][0]][D[M][1]][D[M][2]]==-1){L[D[M][0]][D[M][1]][D[M][2]]=p;C.push(new THREE.Vector3(D[M][0],D[M][1],D[M][2]));p++}}a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[1][0]][D[1][1]][D[1][2]],L[D[2][0]][D[2][1]][D[2][2]]));x++;a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[2][0]][D[2][1]][D[2][2]],L[D[3][0]][D[3][1]][D[3][2]]));x++;a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[4][0]][D[4][1]][D[4][2]],L[D[1][0]][D[1][1]][D[1][2]]));x++}}}}}else{if(K==6){if((!J&&!V)||(!O&&!H)||(!N&&!G)||(!I&&!T)||(!J&&!O)||(!T&&!G)||(!V&&!H)||(!I&&!N)||(!J&&!I)||(!H&&!G)||(!V&&!T)||(!O&&!N)){if(!J&&!V){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[3][0]=R+1;D[3][1]=Q;D[3][2]=P+1;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P}else{if(!O&&!H){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[3][0]=R+1;D[3][1]=Q;D[3][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P+1;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P+1}else{if(!N&&!G){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P}else{if(!I&&!T){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P+1;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P+1}else{if(!J&&!O){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P+1;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P;D[3][0]=R+1;D[3][1]=Q;D[3][2]=P}else{if(!T&&!G){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P+1;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P}else{if(!V&&!H){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q;D[2][2]=P;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P}else{if(!I&&!N){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P+1;D[3][0]=R+1;D[3][1]=Q;D[3][2]=P+1;D[2][0]=R;D[2][1]=Q;D[2][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P}else{if(!J&&!I){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P;D[3][0]=R+1;D[3][1]=Q;D[3][2]=P}else{if(!H&&!G){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P+1;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P+1;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P}else{if(!V&&!T){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q;D[2][2]=P;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P}else{if(!O&&!N){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P+1;D[3][0]=R;D[3][1]=Q;D[3][2]=P+1;D[2][0]=R;D[2][1]=Q;D[2][2]=P;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P}}}}}}}}}}}}for(M=0;M<4;++M){if(L[D[M][0]][D[M][1]][D[M][2]]==-1){L[D[M][0]][D[M][1]][D[M][2]]=p;C.push(new THREE.Vector3(D[M][0],D[M][1],D[M][2]));p++}}a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[1][0]][D[1][1]][D[1][2]],L[D[2][0]][D[2][1]][D[2][2]]));x++;a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[2][0]][D[2][1]][D[2][2]],L[D[3][0]][D[3][1]][D[3][2]]));x++}else{if((!J&&!G)||(!V&&!N)||(!O&&!T)||(!H&&!I)){if(!J&&!G){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P;D[3][0]=R;D[3][1]=Q;D[3][2]=P+1;D[4][0]=R;D[4][1]=Q+1;D[4][2]=P;D[5][0]=R+1;D[5][1]=Q;D[5][2]=P}else{if(!V&&!N){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P;D[3][0]=R+1;D[3][1]=Q;D[3][2]=P+1;D[4][0]=R;D[4][1]=Q;D[4][2]=P;D[5][0]=R+1;D[5][1]=Q+1;D[5][2]=P}else{if(!O&&!T){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P+1;D[4][0]=R+1;D[4][1]=Q+1;D[4][2]=P;D[5][0]=R;D[5][1]=Q;D[5][2]=P}else{if(!H&&!I){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q;D[2][2]=P;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P+1;D[4][0]=R+1;D[4][1]=Q;D[4][2]=P;D[5][0]=R;D[5][1]=Q+1;D[5][2]=P}}}}for(M=0;M<6;++M){if(L[D[M][0]][D[M][1]][D[M][2]]==-1){L[D[M][0]][D[M][1]][D[M][2]]=p;C.push(new THREE.Vector3(D[M][0],D[M][1],D[M][2]));p++}}a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[1][0]][D[1][1]][D[1][2]],L[D[2][0]][D[2][1]][D[2][2]]));x++;a.push(new THREE.Face3(L[D[3][0]][D[3][1]][D[3][2]],L[D[4][0]][D[4][1]][D[4][2]],L[D[5][0]][D[5][1]][D[5][2]]));x++}else{if((!J&&!T)||(!V&&!I)||(!V&&!G)||(!H&&!T)||(!H&&!N)||(!O&&!G)||(!O&&!I)||(!J&&!N)||(!I&&!G)||(!T&&!N)||(!J&&!H)||(!V&&!O)){if(!J&&!T){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P+1}else{if(!V&&!I){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P+1;D[2][0]=R;D[2][1]=Q;D[2][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P+1;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P}else{if(!V&&!G){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P+1;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P+1}else{if(!H&&!T){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P+1;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P;D[1][0]=R;D[1][1]=Q;D[1][2]=P+1;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P}else{if(!H&&!N){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P+1;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[3][0]=R;D[3][1]=Q;D[3][2]=P+1}else{if(!O&&!G){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P+1;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P+1;D[3][0]=R;D[3][1]=Q;D[3][2]=P}else{if(!O&&!I){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P+1;D[2][0]=R;D[2][1]=Q;D[2][2]=P;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P;D[3][0]=R+1;D[3][1]=Q;D[3][2]=P+1}else{if(!J&&!N){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P+1;D[3][0]=R+1;D[3][1]=Q;D[3][2]=P}else{if(!I&&!G){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P+1;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[3][0]=R+1;D[3][1]=Q+1;D[3][2]=P}else{if(!T&&!N){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P+1;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[3][0]=R;D[3][1]=Q+1;D[3][2]=P}else{if(!J&&!H){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P+1;D[3][0]=R;D[3][1]=Q;D[3][2]=P+1}else{if(!V&&!O){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P+1;D[3][0]=R+1;D[3][1]=Q;D[3][2]=P+1}}}}}}}}}}}}for(M=0;M<4;++M){if(L[D[M][0]][D[M][1]][D[M][2]]==-1){L[D[M][0]][D[M][1]][D[M][2]]=p;C.push(new THREE.Vector3(D[M][0],D[M][1],D[M][2]));p++}}a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[1][0]][D[1][1]][D[1][2]],L[D[2][0]][D[2][1]][D[2][2]]));x++;a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[2][0]][D[2][1]][D[2][2]],L[D[3][0]][D[3][1]][D[3][2]]));x++}}}}else{if(K==7){if(!J){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P;D[2][0]=R;D[2][1]=Q;D[2][2]=P+1}else{if(!V){D[0][0]=R;D[0][1]=Q;D[0][2]=P;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P+1}else{if(!H){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P+1}else{if(!O){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P;D[1][0]=R;D[1][1]=Q;D[1][2]=P;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P+1}else{if(!I){D[0][0]=R+1;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q+1;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q;D[2][2]=P}else{if(!T){D[0][0]=R+1;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R+1;D[2][1]=Q;D[2][2]=P}else{if(!G){D[0][0]=R;D[0][1]=Q+1;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q;D[1][2]=P+1;D[2][0]=R+1;D[2][1]=Q+1;D[2][2]=P}else{if(!N){D[0][0]=R;D[0][1]=Q;D[0][2]=P+1;D[1][0]=R+1;D[1][1]=Q+1;D[1][2]=P+1;D[2][0]=R;D[2][1]=Q+1;D[2][2]=P}}}}}}}}for(M=0;M<3;++M){if(L[D[M][0]][D[M][1]][D[M][2]]==-1){L[D[M][0]][D[M][1]][D[M][2]]=p;C.push(new THREE.Vector3(D[M][0],D[M][1],D[M][2]));p++}}a.push(new THREE.Face3(L[D[0][0]][D[0][1]][D[0][2]],L[D[1][0]][D[1][1]][D[1][2]],L[D[2][0]][D[2][1]][D[2][2]]));x++}}}}}}}}this.faces=a;this.verts=C;for(R=0;R<p;++R){C[R].atomid=t[C[R].x*s*l+l*C[R].y+C[R].z].atomid}}});